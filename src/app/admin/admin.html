<ul class="nav nav-tabs justify-content-center mb-4">
  <li class="nav-item">
    <a
      class="nav-link fw-semibold"
      [class.active]="activeTab === 'users'"
      (click)="setTab('users')"
    >
      üë• Ng∆∞·ªùi d√πng
    </a>
  </li>
  <li class="nav-item">
    <a
      class="nav-link fw-semibold"
      [class.active]="activeTab === 'products'"
      (click)="setTab('products')"
    >
      üöó S·∫£n ph·∫©m
    </a>
  </li>
  <li class="nav-item">
    <a
      class="nav-link fw-semibold"
      [class.active]="activeTab === 'orders'"
      (click)="setTab('orders')"
    >
      üì¶ ƒê∆°n h√†ng
    </a>
  </li>
  <li class="nav-item">
    <a
      class="nav-link fw-semibold"
      [class.active]="activeTab === 'testDrive'"
      (click)="setTab('testDrive')"
    >
      üß≠ ƒêƒÉng k√Ω l√°i th·ª≠
    </a>
  </li>
</ul>

<div *ngIf="activeTab === 'users'" class="mt-3 card p-4 shadow-sm">
  <h2 class="card-title mb-4">Qu·∫£n L√Ω Ng∆∞·ªùi D√πng</h2>

  <form [formGroup]="userForm" (ngSubmit)="saveUser()" class="row g-3 mb-5">
    <div class="col-md-3">
      <input formControlName="name" placeholder="T√™n" class="form-control" />
    </div>
    <div class="col-md-3">
      <input formControlName="email" placeholder="Email" class="form-control" type="email" />
    </div>
    <div class="col-md-3">
      <input
        formControlName="password"
        type="password"
        class="form-control"
        placeholder="{{ editingUser ? 'M·∫≠t kh·∫©u m·ªõi (ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi)' : 'M·∫≠t kh·∫©u' }}"
      />
    </div>
    <div class="col-md-1">
      <select formControlName="role" class="form-select">
        <option value="customer">Customer</option>
        <option value="admin">Admin</option>
      </select>
    </div>
    <div class="col-md-2 d-flex gap-2">
      <button type="submit" [disabled]="!userForm.valid" class="btn btn-primary w-100">
        <i class="fas fa-save me-1"></i> {{ editingUser ? 'C·∫≠p nh·∫≠t' : 'Th√™m m·ªõi' }}
      </button>
      <button
        type="button"
        *ngIf="editingUser"
        (click)="cancelEditUser()"
        class="btn btn-secondary"
      >
        H·ªßy
      </button>
    </div>
  </form>
  <div class="filters mb-3 p-2 border rounded bg-light">
    <div class="row g-2 align-items-center">
      <div class="col-md-3">
        <input
          type="text"
          class="form-control"
          [(ngModel)]="searchUser"
          placeholder="T√¨m theo t√™n t√†i kho·∫£n..."
          (input)="applyUsersFilter()"
        />
      </div>

      <div class="col-md-2">
        <select class="form-select" [(ngModel)]="filterRole" (change)="applyUsersFilter()">
          <option value="">-- Ph√¢n lo·∫°i --</option>
          <option value="admin">Qu·∫£n tr·ªã vi√™n</option>
          <option value="customer">Ng∆∞·ªùi d√πng</option>
          <option value="sales_staff">Nh√¢n vi√™n</option>
        </select>
      </div>

      <div class="col-md-1">
        <button class="btn btn-secondary w-100" (click)="resetUsersFilter()">
          <i class="fas fa-redo-alt"></i>
        </button>
      </div>
    </div>
  </div>
  <div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Role</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of filteredUsers">
          <td>{{ user.id }}</td>
          <td>{{ user.name }}</td>
          <td>{{ user.email }}</td>
          <td>
            <span
              class="badge"
              [ngClass]="{
                'bg-primary': user.role === 'admin',
                'bg-info': user.role === 'customer'
              }"
              >{{ user.role | uppercase }}</span
            >
          </td>
          <td>
            <button (click)="editUser(user)" class="btn btn-sm btn-outline-warning me-2">
              <i class="fas fa-edit"></i> S·ª≠a
            </button>
            <button (click)="deleteUser(user)" class="btn btn-sm btn-outline-danger">
              <i class="fas fa-trash-alt"></i> X√≥a
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div *ngIf="activeTab === 'products'" class="mt-3">
  <div *ngIf="selectedProductForDetails" class="product-attributes-card card p-4 mb-4 shadow-lg">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3 class="text-primary m-0">
        <i class="fas fa-cogs me-2"></i> Chi ti·∫øt cho S·∫£n ph·∫©m:
        <strong>{{ selectedProductForDetails.name }}</strong> (ID:
        {{ selectedProductForDetails.id }})
      </h3>
      <button class="btn btn-secondary" (click)="closeProductAttributes()">
        <i class="fas fa-arrow-left me-1"></i> Quay l·∫°i Danh s√°ch
      </button>
    </div>
    <hr />

    <h4 class="mt-4 mb-3 text-info">
      <i class="fas fa-ruler-combined me-1"></i> Th√¥ng s·ªë K·ªπ thu·∫≠t
    </h4>
    <form [formGroup]="detailsForm" (ngSubmit)="saveDetails()" class="row g-3">
      <div class="col-md-4">
        <label class="form-label">ƒê·ªông c∆°</label>
        <input formControlName="dong_co" class="form-control" placeholder="Vd: XƒÉng, 2.0L" />
      </div>
      <div class="col-md-4">
        <label class="form-label">H·ªôp s·ªë</label>
        <input formControlName="hop_so" class="form-control" placeholder="Vd: T·ª± ƒë·ªông 6 c·∫•p" />
      </div>
      <div class="col-md-4">
        <label class="form-label">Dung t√≠ch xi lanh</label>
        <input
          formControlName="dung_tich_xi_lanh"
          class="form-control"
          placeholder="Vd: 1,998 cc"
        />
      </div>
      <div class="col-md-4">
        <label class="form-label">D√†i x R·ªông x Cao</label>
        <input
          formControlName="dai_rong_cao"
          class="form-control"
          placeholder="Vd: 4500 x 1850 x 1680 (mm)"
        />
      </div>
      <div class="col-md-4">
        <label class="form-label">Chi·ªÅu d√†i c∆° s·ªü</label>
        <input formControlName="chieu_dai_co_so" class="form-control" placeholder="Vd: 2,700 mm" />
      </div>
      <div class="col-md-4">
        <label class="form-label">Kho·∫£ng s√°ng g·∫ßm</label>
        <input formControlName="khoang_sang_gam_xe" class="form-control" placeholder="Vd: 190 mm" />
      </div>
      <div class="col-md-4">
        <label class="form-label">Ti√™u th·ª• T.H·ª£p</label>
        <input
          formControlName="tieu_thu_tong_hop"
          class="form-control"
          placeholder="Vd: 8.5 L/100km"
        />
      </div>
      <div class="col-md-4">
        <label class="form-label">Ti√™u th·ª• ƒê.Th·ªã</label>
        <input
          formControlName="tieu_thu_do_thi"
          class="form-control"
          placeholder="Vd: 10.2 L/100km"
        />
      </div>
      <div class="col-md-4">
        <label class="form-label">Ti√™u th·ª• N.ƒê.Th·ªã</label>
        <input
          formControlName="tieu_thu_ngoai_do_thi"
          class="form-control"
          placeholder="Vd: 7.0 L/100km"
        />
      </div>
      <div class="col-12 mt-4">
        <button type="submit" class="btn btn-success">
          <i class="fas fa-save me-1"></i>
          {{ productDetails ? 'C·∫≠p nh·∫≠t Th√¥ng s·ªë' : 'Th√™m Th√¥ng s·ªë' }}
        </button>
      </div>
    </form>

    <h4 class="mt-5 mb-3 text-warning"><i class="fas fa-images me-1"></i> Qu·∫£n l√Ω H√¨nh ·∫£nh Ph·ª•</h4>

    <form
      [formGroup]="imageForm"
      (ngSubmit)="addImage()"
      class="row g-3 align-items-end mb-4 p-3 border rounded bg-light"
    >
      <div class="col-md-7">
        <label class="form-label">URL H√¨nh ·∫£nh</label>
        <input
          formControlName="image_url"
          class="form-control"
          placeholder="http://... (ƒê·∫£m b·∫£o l√† link h·ª£p l·ªá)"
        />
      </div>
      <div class="col-md-3">
        <label class="form-label">H√¨nh ch√≠nh?</label>
        <select formControlName="is_main" class="form-select">
          <option [value]="0">Kh√¥ng (H√¨nh ph·ª•)</option>
          <option [value]="1">C√≥ (ƒê·∫∑t l√†m h√¨nh ch√≠nh)</option>
        </select>
      </div>
      <div class="col-md-2">
        <button type="submit" class="btn btn-primary w-100" [disabled]="!imageForm.valid">
          <i class="fas fa-plus me-1"></i> Th√™m
        </button>
      </div>
    </form>

    <div class="image-list d-flex flex-wrap gap-3 p-3 border rounded bg-white">
      <div
        *ngFor="let img of productImages"
        class="border p-2 rounded text-center shadow-sm position-relative"
        style="width: 150px"
      >
        <img
          [src]="img.image_url"
          width="100%"
          height="100"
          style="object-fit: cover; border-radius: 4px"
          alt="Product Image"
        />
        <p class="mt-2 mb-1">
          <span
            *ngIf="img.is_main === 1"
            class="badge bg-danger position-absolute top-0 start-0 translate-middle badge-pill p-2"
            ><i class="fas fa-star"></i> CH√çNH</span
          >
        </p>
        <button class="btn btn-sm btn-outline-danger mt-1 w-100" (click)="deleteImage(img.id!)">
          <i class="fas fa-times me-1"></i> X√≥a
        </button>
      </div>
      <div *ngIf="productImages.length === 0" class="alert alert-info w-100 text-center">
        Ch∆∞a c√≥ h√¨nh ·∫£nh ph·ª• n√†o cho s·∫£n ph·∫©m n√†y.
      </div>
    </div>
  </div>
  <div *ngIf="!selectedProductForDetails">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2>Danh s√°ch s·∫£n ph·∫©m</h2>
      <button class="btn btn-primary" (click)="toggleProductForm()">
        <i class="fas fa-plus me-1"></i> Th√™m s·∫£n ph·∫©m m·ªõi
      </button>
    </div>
    <!-- FORM th√™m/s·ª≠a s·∫£n ph·∫©m (·∫©n m·∫∑c ƒë·ªãnh) -->
    <div *ngIf="showProductForm" class="card p-4 mb-4 shadow-sm">
      <h5 class="card-title">
        {{ editingProduct ? 'C·∫≠p nh·∫≠t s·∫£n ph·∫©m' : 'Th√™m s·∫£n ph·∫©m m·ªõi' }}
      </h5>
      <form [formGroup]="productForm" (ngSubmit)="saveProduct()" class="row g-3">
        <div class="col-md-3">
          <input formControlName="name" placeholder="T√™n s·∫£n ph·∫©m" class="form-control" />
        </div>
        <div class="col-md-3">
          <input
            formControlName="category_id"
            type="number"
            placeholder="Category ID"
            class="form-control"
          />
        </div>
        <div class="col-md-3">
          <input
            formControlName="price"
            type="number"
            placeholder="Gi√° (VND)"
            class="form-control"
          />
        </div>
        <div class="col-md-3">
          <input
            formControlName="stock"
            type="number"
            placeholder="S·ªë l∆∞·ª£ng t·ªìn"
            class="form-control"
          />
        </div>

        <div class="col-md-3">
          <input formControlName="image_url" placeholder="URL h√¨nh ch√≠nh" class="form-control" />
        </div>
        <div class="col-md-3">
          <input formControlName="img_hover" placeholder="URL h√¨nh hover" class="form-control" />
        </div>
        <div class="col-md-3">
          <select formControlName="status" class="form-select">
            <option value="active">Active</option>
            <option value="inactive">Inactive</option>
          </select>
        </div>

        <div class="col-md-2">
          <input formControlName="so_cho_ngoi" placeholder="S·ªë ch·ªó ng·ªìi" class="form-control" />
        </div>
        <div class="col-md-2">
          <input formControlName="kieu_dang" placeholder="Ki·ªÉu d√°ng" class="form-control" />
        </div>
        <div class="col-md-2">
          <input formControlName="nhien_lieu" placeholder="Nhi√™n li·ªáu" class="form-control" />
        </div>
        <div class="col-md-2">
          <input formControlName="xuat_xu" placeholder="Xu·∫•t x·ª©" class="form-control" />
        </div>
        <div class="col-md-2">
          <input formControlName="loai_xe" placeholder="Lo·∫°i xe" class="form-control" />
        </div>

        <div class="col-md-6">
          <textarea
            formControlName="description"
            placeholder="M√¥ t·∫£ ng·∫Øn"
            class="form-control"
            rows="2"
          ></textarea>
        </div>
        <div class="col-md-6">
          <textarea
            formControlName="mo_ta_chi_tiet"
            placeholder="M√¥ t·∫£ chi ti·∫øt"
            class="form-control"
            rows="2"
          ></textarea>
        </div>

        <div class="col-12 d-flex gap-2">
          <button type="submit" [disabled]="!productForm.valid" class="btn btn-success">
            <i class="fas fa-save me-1"></i>
            {{ editingProduct ? 'C·∫≠p nh·∫≠t' : 'Th√™m m·ªõi' }}
          </button>
          <button type="button" class="btn btn-secondary" (click)="cancelProductForm()">H·ªßy</button>
        </div>
      </form>
    </div>
    <div class="filters mb-3 p-2 border rounded bg-light">
      <div class="row g-2 align-items-center">
        <div class="col-md-3">
          <input
            type="text"
            class="form-control"
            [(ngModel)]="searchProduct"
            placeholder="T√¨m theo t√™n xe..."
            (input)="applyProductsFilter()"
          />
        </div>

        <div class="col-md-2">
          <select class="form-select" [(ngModel)]="filterCategory" (change)="applyProductsFilter()">
            <option value="">-- Lo·∫°i xe --</option>
            <option value="SUV">SUV</option>
            <option value="Sedan">Sedan</option>
            <option value="Hatchback">Hatchback</option>
            <option value="MPV">MPV</option>
          </select>
        </div>

        <div class="col-md-2">
          <select class="form-select" [(ngModel)]="filterSeats" (change)="applyProductsFilter()">
            <option value="">-- S·ªë ch·ªó ng·ªìi --</option>
            <option value="4">4 ch·ªó</option>
            <option value="5">5 ch·ªó</option>
            <option value="7">7 ch·ªó</option>
            <option value="9">9 ch·ªó</option>
          </select>
        </div>

        <div class="col-md-2">
          <select class="form-select" [(ngModel)]="filterOrigin" (change)="applyProductsFilter()">
            <option value="">-- Xu·∫•t x·ª© --</option>
            <option value="Vi·ªát Nam">Vi·ªát Nam</option>
            <option value="Th√°i Lan">Th√°i Lan</option>
            <option value="Nh·∫≠t B·∫£n">Nh·∫≠t B·∫£n</option>
            <option value="H√†n Qu·ªëc">H√†n Qu·ªëc</option>
          </select>
        </div>

        <div class="col-md-2">
          <select class="form-select" [(ngModel)]="filterPrice" (change)="applyProductsFilter()">
            <option value="">-- Gi√° ti·ªÅn --</option>
            <option value="duoi500">D∆∞·ªõi 500 tri·ªáu</option>
            <option value="500to800">500 - 800 tri·ªáu</option>
            <option value="800to1b">800 tri·ªáu - 1 t·ª∑</option>
            <option value="tren1b">Tr√™n 1 t·ª∑</option>
          </select>
        </div>

        <div class="col-md-1">
          <button class="btn btn-secondary w-100" (click)="resetProductsFilter()">
            <i class="fas fa-redo-alt"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- DANH S√ÅCH S·∫¢N PH·∫®M -->
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>ID</th>
            <th>T√™n xe</th>
            <th>Gi√°</th>
            <th>T·ªìn</th>
            <th>·∫¢nh</th>
            <th>H√†nh ƒë·ªông</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of filteredProducts">
            <td>{{ p.id }}</td>
            <td>{{ p.name }}</td>
            <td>{{ p.price | currency : 'VND' }}</td>
            <td>{{ p.stock }}</td>
            <td>
              <img
                [src]="p.image_url"
                width="100"
                height="60"
                class="rounded"
                style="object-fit: cover"
              />
            </td>
            <td>
              <div class="btn-group">
                <button class="btn btn-sm btn-warning" (click)="toggleProductForm(p)">
                  <i class="fas fa-edit"></i> S·ª≠a
                </button>
                <button class="btn btn-sm btn-info text-white" (click)="openProductAttributes(p)">
                  <i class="fas fa-list-alt"></i> Chi ti·∫øt/·∫¢nh
                </button>
                <button class="btn btn-sm btn-danger" (click)="deleteProduct(p)">
                  <i class="fas fa-trash-alt"></i> X√≥a
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div *ngIf="activeTab === 'orders'">
  <h2>Qu·∫£n l√Ω ƒê∆°n h√†ng</h2>
  <div class="filters card p-3 mb-4 shadow-sm">
    <div class="row g-3">
      <div class="col-lg-3">
        <input
          type="text"
          [(ngModel)]="searchOrder"
          class="form-control"
          placeholder="üîç T√¨m theo T√™n..."
          (input)="appleOrderFilter()"
        />
      </div>
      <div class="col-lg-3">
        <input
          type="date"
          [(ngModel)]="filterDateOrders"
          class="form-control"
          (change)="appleOrderFilter()"
        />
      </div>
      <div class="col-lg-3">
        <select [(ngModel)]="filterStatusOrder" class="form-select" (change)="appleOrderFilter()">
          <option value="">-- Tr·∫°ng th√°i --</option>
          <option value="pending">Ch·ªù duy·ªát</option>
          <option value="cancelled">Hu·ª∑ h√†ng</option>
          <option value="confirmed">Giao h√†ng th√†nh c√¥ng</option>
        </select>
      </div>
      <div class="col-lg-3">
        <button class="btn btn-secondary w-100" (click)="resetTestDriveFilter()">
          <i class="fas fa-redo-alt me-1"></i> ƒê·∫∑t l·∫°i
        </button>
      </div>
    </div>
  </div>
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>ID</th>
          <th>Kh√°ch h√†ng</th>
          <th>T·ªïng ti·ªÅn</th>
          <th>Tr·∫°ng th√°i</th>
          <th>Ng√†y ƒë·∫∑t</th>
          <th>H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let o of filteredOrders">
          <td>#{{ o.id }}</td>
          <td>{{ o.user_name }}</td>
          <td>{{ o.total_amount | currency : 'VND' }}</td>
          <td>
            <span
              class="badge"
              [class.bg-warning]="o.status === 'pending'"
              [class.bg-success]="o.status === 'confirmed' || o.status === 'completed'"
              [class.bg-danger]="o.status === 'cancelled' || o.status === 'returned'"
            >
              {{ o.status | uppercase }}
            </span>
          </td>
          <td>{{ o.order_date | date : 'short' }}</td>
          <td>
            <button class="btn btn-sm btn-primary" (click)="viewOrderDetails(o)">
              Xem chi ti·∫øt
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="selectedOrder" class="modal-backdrop">
    <div class="modal-content-lg">
      <h4 class="modal-title">Chi ti·∫øt ƒê∆°n h√†ng #{{ selectedOrder.id }}</h4>
      <div class="p-3 border rounded mb-3">
        <p>
          <strong>Kh√°ch h√†ng:</strong> {{ selectedOrder.user_name }} ({{ selectedOrder.email }})
        </p>
        <p><strong>Ng√†y ƒë·∫∑t:</strong> {{ selectedOrder.order_date | date : 'short' }}</p>
        <p><strong>T·ªïng ti·ªÅn:</strong> {{ selectedOrder.total_amount | currency : 'VND' }}</p>
        <p>
          <strong>Tr·∫°ng th√°i hi·ªán t·∫°i:</strong>
          <span
            class="badge fs-6"
            [class.bg-warning]="selectedOrder.status === 'pending'"
            [class.bg-success]="
              selectedOrder.status === 'confirmed' || selectedOrder.status === 'completed'
            "
            [class.bg-danger]="
              selectedOrder.status === 'cancelled' || selectedOrder.status === 'returned'
            "
          >
            {{ selectedOrder.status | uppercase }}
          </span>
        </p>
        <h5 class="mt-3">C·∫≠p nh·∫≠t Tr·∫°ng th√°i</h5>
        <div class="btn-group">
          <button
            class="btn btn-outline-success"
            (click)="updateOrderDetailsStatus('confirmed')"
            [disabled]="selectedOrder.status === 'confirmed'"
          >
            X√°c nh·∫≠n
          </button>
          <button
            class="btn btn-outline-primary"
            (click)="updateOrderDetailsStatus('completed')"
            [disabled]="selectedOrder.status === 'completed'"
          >
            Ho√†n th√†nh
          </button>
          <button
            class="btn btn-outline-danger"
            (click)="updateOrderDetailsStatus('cancelled')"
            [disabled]="selectedOrder.status === 'cancelled'"
          >
            H·ªßy ƒë∆°n
          </button>
          <button
            class="btn btn-outline-warning"
            (click)="updateOrderDetailsStatus('returned')"
            [disabled]="selectedOrder.status === 'returned'"
          >
            Tr·∫£ h√†ng
          </button>
        </div>
      </div>
      <h5 class="mt-4">S·∫£n ph·∫©m</h5>
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>·∫¢nh</th>
              <th>T√™n s·∫£n ph·∫©m</th>
              <th>Gi√° t·∫°i th·ªùi ƒëi·ªÉm ƒë·∫∑t</th>
              <th>S·ªë l∆∞·ª£ng</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of selectedOrder.details">
              <td>
                <img [src]="item.image_url" width="50" height="50" style="object-fit: cover" />
              </td>
              <td>{{ item.product_name }}</td>
              <td>{{ item.price_at_order | currency : 'VND' }}</td>
              <td>{{ item.quantity }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <button class="btn btn-secondary mt-4 w-100" (click)="closeOrderDetails()">ƒê√≥ng</button>
    </div>
  </div>
</div>

<div *ngIf="activeTab === 'testDrive'" class="mt-3">
  <h4 class="mb-3">Danh s√°ch ƒêƒÉng k√Ω L√°i th·ª≠</h4>

  <div class="filters card p-3 mb-4 shadow-sm">
    <div class="row g-3">
      <div class="col-lg-3">
        <input
          type="text"
          [(ngModel)]="searchTestDrive"
          class="form-control"
          placeholder="üîç T√¨m theo T√™n ho·∫∑c SƒêT..."
          (input)="applyTestDriveFilter()"
        />
      </div>
      <div class="col-lg-3">
        <input
          type="date"
          [(ngModel)]="filterDate"
          class="form-control"
          (change)="applyTestDriveFilter()"
        />
      </div>
      <div class="col-lg-3">
        <select [(ngModel)]="filterStatus" class="form-select" (change)="applyTestDriveFilter()">
          <option value="">-- Tr·∫°ng th√°i --</option>
          <option value="pending">Ch·ªù duy·ªát</option>
          <option value="approved">ƒê√£ duy·ªát</option>
          <option value="test_completed">ƒê√£ l√°i th·ª≠</option>
          <option value="rejected">T·ª´ ch·ªëi</option>
        </select>
      </div>
      <div class="col-lg-3">
        <button class="btn btn-secondary w-100" (click)="resetTestDriveFilter()">
          <i class="fas fa-redo-alt me-1"></i> ƒê·∫∑t l·∫°i
        </button>
      </div>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-hover text-center align-middle">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Xe</th>
          <th>Ng∆∞·ªùi ƒëƒÉng k√Ω</th>
          <th>ƒêi·ªán tho·∫°i</th>
          <th>ƒê·∫°i l√Ω</th>
          <th>Ng√†y h·∫πn</th>
          <th>Tr·∫°ng th√°i</th>
          <th>Thao t√°c</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of filteredTestDriveList">
          <td>{{ item.id }}</td>
          <td class="text-start">
            <img
              [src]="item.product_image"
              width="70"
              class="rounded me-2"
              style="object-fit: cover; border: 1px solid #ddd"
            />
            <span class="fw-bold">{{ item.product_name }}</span>
          </td>
          <td>{{ item.fullname }}</td>
          <td>
            <a href="tel:{{ item.phone }}">{{ item.phone }}</a>
          </td>
          <td>{{ item.dealer }} ({{ item.city }})</td>
          <td>{{ item.date_schedule | date : 'dd/MM/yyyy' }}</td>
          <td [ngClass]="getStatusClass(item.status)" class="fw-bold rounded">
            {{ item.status | uppercase }}
          </td>
          <td>
            <select
              [(ngModel)]="item.status"
              (change)="updateTestDriveStatus(item)"
              class="form-select form-select-sm"
            >
              <option value="pending">Ch·ªù duy·ªát</option>
              <option value="approved">ƒê√£ duy·ªát</option>
              <option value="test_completed">ƒê√£ l√°i th·ª≠</option>
              <option value="rejected">T·ª´ ch·ªëi</option>
            </select>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
