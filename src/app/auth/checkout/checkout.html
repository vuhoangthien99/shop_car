<div class="checkout-container">
    <div class="checkout-header">
        <h1>Xác nhận Thanh toán</h1>
        <p>Vui lòng kiểm tra lại đơn hàng và chọn phương thức thanh toán.</p>
    </div>

    <div *ngIf="errorMessage" class="alert alert-danger">
        <strong>Lỗi:</strong> {{ errorMessage }}
    </div>

    <div class="order-summary">
        <h2>Thông tin Đơn hàng ({{ totalQuantity }} sản phẩm)</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Sản phẩm</th>
                    <th class="text-center">Số lượng</th>
                    <th class="text-right">Đơn giá</th>
                    <th class="text-right">Thành tiền</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of items">
                    <td>{{ item.name }}</td>
                    <td class="text-center">{{ item.quantity }}</td>
                    <td class="text-right">{{ item.price | currency:'VND':'symbol':'1.0-0' }}</td>
                    <td class="text-right">{{ (item.price * item.quantity) | currency:'VND':'symbol':'1.0-0' }}</td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3" class="text-right"><strong>TỔNG CỘNG:</strong></td>
                    <td class="text-right total-amount">{{ totalAmount | currency:'VND':'symbol':'1.0-0' }}</td>
                </tr>
            </tfoot>
        </table>
    </div>

    <div class="payment-method-selection">
        <h2>Phương thức Thanh toán</h2>
        <form (ngSubmit)="processCheckout()">
            <div class="form-group">
                <label class="payment-option">
                    <input 
                        type="radio" 
                        name="payment" 
                        [(ngModel)]="paymentMethod" 
                        value="cash"
                        required
                    > 
                    Thanh toán khi nhận hàng (COD)
                </label>
            </div>
            
            <div class="form-group">
                <label class="payment-option">
                    <input 
                        type="radio" 
                        name="payment" 
                        [(ngModel)]="paymentMethod" 
                        value="bank_transfer"
                        required
                    > 
                    Chuyển khoản Ngân hàng
                </label>
            </div>

            <button 
                type="submit" 
                class="btn-checkout"
                [disabled]="processing || items.length === 0"
            >
                <span *ngIf="!processing">HOÀN TẤT ĐẶT HÀNG</span>
                <span *ngIf="processing">Đang xử lý...</span>
            </button>
        </form>
    </div>
    
    <div class="back-link">
        <a [routerLink]="['/cart']">Quay lại Giỏ hàng</a>
    </div>

</div>